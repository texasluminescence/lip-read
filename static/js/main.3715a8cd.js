(()=>{"use strict";var e={2388:(e,t,r)=>{var o=r(2299),n=r(6665),a=r(3049),i=r(9984),s=r(4489),l=r(1240),c=r(3668),d=r(3929),u=r(6283),f=r(5648),g=r(484),h=r(5072),b=(r(8941),r(76));const y=async()=>{try{return await new Promise(((e,t)=>{const r=document.createElement("input");r.type="file",r.accept="video/*",r.onchange=r=>{const o=r.target.files;if(o&&o.length>0){const t=URL.createObjectURL(o[0]);e(t)}else t(new Error("No file selected"))},r.click()}))}catch(e){return console.error("Error picking video:",e),null}try{const e=await b.getDocumentAsync({type:"video/*",copyToCacheDirectory:!0});return e.canceled?(console.log("Document picker was canceled"),null):e.assets&&e.assets.length>0?(console.log("Selected video file:",e.assets[0].uri),e.assets[0].uri):null}catch(e){return console.error("Error picking document:",e),null}};var x=r(397);const m=c.default.create({container:{flex:1,backgroundColor:"#f5f5f5",padding:20},header:{marginTop:40,alignItems:"center"},title:{fontSize:32,fontWeight:"bold",color:"#333"},subtitle:{fontSize:16,color:"#666",marginTop:5},content:{flex:1,justifyContent:"center",alignItems:"center"},logo:{width:150,height:150,marginBottom:30},description:{fontSize:16,color:"#666",textAlign:"center",marginHorizontal:20,lineHeight:24},actions:{marginBottom:40},button:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:16,borderRadius:10,marginVertical:10},primaryButton:{backgroundColor:"#4285F4"},secondaryButton:{backgroundColor:"#34A853"},buttonText:{color:"white",fontSize:16,fontWeight:"bold",marginLeft:10}}),p=()=>{const e=(0,i.useNavigation)();return(0,x.jsxs)(d.default,{style:m.container,children:[(0,x.jsx)(a.StatusBar,{style:"dark"}),(0,x.jsxs)(d.default,{style:m.header,children:[(0,x.jsx)(u.default,{style:m.title,children:"LipSeek"}),(0,x.jsx)(u.default,{style:m.subtitle,children:"Lip Reading App"})]}),(0,x.jsxs)(d.default,{style:m.content,children:[(0,x.jsx)(g.default,{source:r(9812),style:m.logo,resizeMode:"contain"}),(0,x.jsx)(u.default,{style:m.description,children:"Record or upload a video of someone speaking and get a transcript of what they said."})]}),(0,x.jsxs)(d.default,{style:m.actions,children:[(0,x.jsxs)(f.default,{style:[m.button,m.primaryButton],onPress:()=>e.navigate("Record"),children:[(0,x.jsx)(h.default,{name:"videocam",size:24,color:"white"}),(0,x.jsx)(u.default,{style:m.buttonText,children:"Record Video"})]}),(0,x.jsxs)(f.default,{style:[m.button,m.secondaryButton],onPress:async()=>{try{const t=await y();t&&e.navigate("Preview",{uri:t})}catch(t){console.error("Error selecting video:",t)}},children:[(0,x.jsx)(h.default,{name:"file-upload",size:24,color:"white"}),(0,x.jsx)(u.default,{style:m.buttonText,children:"Upload Video"})]})]})]})};r(8902),r(9202);c.default.create({container:{flex:1,backgroundColor:"black"},camera:{flex:1},controlsContainer:{flex:1,backgroundColor:"transparent",justifyContent:"flex-end"},buttonContainer:{flexDirection:"row",justifyContent:"space-around",alignItems:"center",marginBottom:30},recordButton:{width:70,height:70,borderRadius:35,backgroundColor:"red",borderWidth:5,borderColor:"white"},recordingButton:{backgroundColor:"white",borderWidth:20,borderColor:"red"},iconButton:{width:50,height:50,justifyContent:"center",alignItems:"center"}});var j=r(5324);const v=c.default.create({container:{flex:1,backgroundColor:"black"},camera:{flex:1,width:"100%",height:"100%",objectFit:"cover"},controlsContainer:{position:"absolute",bottom:0,left:0,right:0,backgroundColor:"transparent"},buttonContainer:{flexDirection:"row",justifyContent:"space-around",alignItems:"center",marginBottom:30},recordButton:{width:70,height:70,borderRadius:35,backgroundColor:"red",borderWidth:5,borderColor:"white"},recordingButton:{backgroundColor:"white",borderWidth:20,borderColor:"red"},iconButton:{width:50,height:50,justifyContent:"center",alignItems:"center"}}),w=({onVideoRecorded:e})=>{const[t,r]=(0,n.useState)(!1),[o,a]=(0,n.useState)(null),[s,l]=(0,n.useState)(null),[c,g]=(0,n.useState)(null),[b,y]=(0,n.useState)(!0),[m,p]=(0,n.useState)("user"),w=(0,n.useRef)(null),C=(0,n.useRef)([]),k=(0,i.useIsFocused)();(0,n.useEffect)((()=>{const e=j.default.addEventListener("change",(e=>{"active"!==e&&s?(s.getTracks().forEach((e=>e.stop())),l(null)):"active"===e&&!s&&k&&B()})),t=()=>{document.hidden&&s?(s.getTracks().forEach((e=>e.stop())),l(null)):document.hidden||s||!k||B()};return document.addEventListener("visibilitychange",t),()=>{e.remove(),document.removeEventListener("visibilitychange",t)}}),[s,k]),(0,n.useEffect)((()=>(k?B():s&&(s.getTracks().forEach((e=>e.stop())),l(null)),()=>{s&&s.getTracks().forEach((e=>e.stop()))})),[k,m]);const B=async()=>{try{s&&s.getTracks().forEach((e=>e.stop()));const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:m},audio:!0});l(e),w.current&&(w.current.srcObject=e),y(!0)}catch(e){console.error("Error accessing camera:",e),y(!1)}},S=async()=>{if(s){C.current=[],r(!0);try{const t=new MediaRecorder(s);t.ondataavailable=e=>{e.data.size>0&&C.current.push(e.data)},t.onstop=()=>{const t=new Blob(C.current,{type:"video/webm"}),o=URL.createObjectURL(t);g(o),e(o),r(!1)},a(t),t.start(),setTimeout((()=>{"recording"===t.state&&R()}),1e4)}catch(t){console.error("Error starting recording:",t),r(!1)}}},R=()=>{o&&"recording"===o.state&&(o.stop(),r(!1))};return b?(0,x.jsxs)(d.default,{style:v.container,children:[(0,x.jsx)("video",{ref:w,style:v.camera,autoPlay:!0,playsInline:!0,muted:!0}),(0,x.jsx)(d.default,{style:v.controlsContainer,children:(0,x.jsxs)(d.default,{style:v.buttonContainer,children:[(0,x.jsx)(f.default,{style:v.iconButton,onPress:()=>{p((e=>"environment"===e?"user":"environment"))},disabled:t,children:(0,x.jsx)(h.default,{name:"flip-camera-ios",size:36,color:"white"})}),t?(0,x.jsx)(f.default,{style:[v.recordButton,v.recordingButton],onPress:R}):(0,x.jsx)(f.default,{style:v.recordButton,onPress:()=>{S()},disabled:t}),(0,x.jsx)(d.default,{style:v.iconButton})]})})]}):(0,x.jsx)(d.default,{style:v.container,children:(0,x.jsx)(u.default,{style:{color:"white"},children:"Camera not available or permission denied"})})},C=e=>(0,x.jsx)(w,Object.assign({},e)),k=c.default.create({container:{flex:1,backgroundColor:"black"},backButton:{position:"absolute",top:50,left:20,width:40,height:40,borderRadius:20,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",zIndex:10},instructions:{position:"absolute",top:50,left:70,right:20,padding:10,backgroundColor:"rgba(0, 0, 0, 0.5)",borderRadius:10},instructionText:{color:"white",textAlign:"center"}}),B=()=>{const e=(0,i.useNavigation)();return(0,x.jsxs)(d.default,{style:k.container,children:[(0,x.jsx)(a.StatusBar,{style:"light"}),(0,x.jsx)(C,{onVideoRecorded:t=>{e.navigate("Preview",{uri:t})}}),(0,x.jsx)(f.default,{style:k.backButton,onPress:()=>e.goBack(),children:(0,x.jsx)(h.default,{name:"arrow-back",size:24,color:"white"})}),(0,x.jsx)(d.default,{style:k.instructions,children:(0,x.jsx)(u.default,{style:k.instructionText,children:"Record a video of someone speaking clearly"})})]})};var S=r(530),R=r(4307);r(9167),r(9771);c.default.create({container:{flex:1,backgroundColor:"black"},video:{flex:1,width:"100%"},controls:{position:"absolute",bottom:0,left:0,right:0,flexDirection:"row",justifyContent:"center",alignItems:"center",padding:20,backgroundColor:"rgba(0, 0, 0, 0.5)"},closeButton:{position:"absolute",top:-40,right:20,width:40,height:40,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)",borderRadius:20},playButton:{width:64,height:64,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)",borderRadius:32,borderWidth:2,borderColor:"white"}});const T=c.default.create({container:{flex:1,overflow:"hidden",borderRadius:10},video:{width:"100%",height:"100%",objectFit:"cover"}}),z=({uri:e,style:t})=>{const r=(0,n.useRef)(null);return(0,n.useEffect)((()=>{r.current&&(r.current.src=e)}),[e]),(0,x.jsx)(d.default,{style:[T.container,t],children:(0,x.jsx)("video",{ref:r,style:T.video,controls:!0,playsInline:!0,autoPlay:!0})})},E=e=>(0,x.jsx)(z,Object.assign({},e));const I=r(7109).default.create({baseURL:"https://api.dermetric.cashel.dev:5555",headers:{"Content-Type":"multipart/form-data"}}),O=c.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},videoContainer:{height:"50%",backgroundColor:"black"},content:{flex:1,padding:20},backButton:{width:40,height:40,borderRadius:20,backgroundColor:"#eee",justifyContent:"center",alignItems:"center",marginBottom:20},actionContainer:{flex:1,justifyContent:"center",alignItems:"center"},button:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingVertical:12,paddingHorizontal:24,borderRadius:10,marginVertical:10},primaryButton:{backgroundColor:"#4285F4"},secondaryButton:{backgroundColor:"#34A853"},buttonText:{color:"white",fontSize:16,fontWeight:"bold",marginLeft:8},loadingContainer:{alignItems:"center"},loadingText:{marginTop:16,fontSize:16,color:"#666"},errorText:{color:"red",marginBottom:16,textAlign:"center"},resultContainer:{flex:1},resultTitle:{fontSize:20,fontWeight:"bold",marginBottom:16,color:"#333"},transcriptContainer:{flex:1,backgroundColor:"white",borderRadius:10,padding:16,marginBottom:16},transcript:{fontSize:18,lineHeight:26,color:"#333"}}),P=()=>{const e=(0,i.useNavigation)(),t=(0,i.useRoute)(),{uri:r}=t.params,[o,s]=(0,n.useState)(!1),[l,c]=(0,n.useState)(null),[g,b]=(0,n.useState)(null);return(0,x.jsxs)(d.default,{style:O.container,children:[(0,x.jsx)(a.StatusBar,{style:"light"}),(0,x.jsx)(d.default,{style:O.videoContainer,children:(0,x.jsx)(E,{uri:r})}),(0,x.jsxs)(d.default,{style:O.content,children:[(0,x.jsx)(f.default,{style:O.backButton,onPress:()=>e.goBack(),children:(0,x.jsx)(h.default,{name:"arrow-back",size:24,color:"#333"})}),l?(0,x.jsxs)(d.default,{style:O.resultContainer,children:[(0,x.jsx)(u.default,{style:O.resultTitle,children:"Transcript"}),(0,x.jsx)(R.default,{style:O.transcriptContainer,children:(0,x.jsx)(u.default,{style:O.transcript,children:l})}),(0,x.jsxs)(f.default,{style:[O.button,O.secondaryButton],onPress:()=>{e.navigate("Home")},children:[(0,x.jsx)(h.default,{name:"refresh",size:20,color:"white"}),(0,x.jsx)(u.default,{style:O.buttonText,children:"Start Over"})]})]}):(0,x.jsx)(d.default,{style:O.actionContainer,children:o?(0,x.jsxs)(d.default,{style:O.loadingContainer,children:[(0,x.jsx)(S.default,{size:"large",color:"#4285F4"}),(0,x.jsx)(u.default,{style:O.loadingText,children:"Analyzing video..."})]}):(0,x.jsxs)(x.Fragment,{children:[g&&(0,x.jsx)(u.default,{style:O.errorText,children:g}),(0,x.jsxs)(f.default,{style:[O.button,O.primaryButton],onPress:async()=>{s(!0),b(null);try{const e=await(async e=>{try{const t=new FormData;if(!e.startsWith("blob:"))throw new Error("Invalid video URI format for web");{const r=await fetch(e),o=await r.blob(),n="webm",a=`video-${Date.now()}.${n}`;t.append("file",o,a)}return(await I.post("/predict",t)).data.prediction}catch(g){throw console.error("Error uploading video:",g),g}})(r);c(e)}catch(e){console.error("Error analyzing video:",e),b("Failed to analyze video. Please try again.")}finally{s(!1)}},children:[(0,x.jsx)(h.default,{name:"auto-awesome",size:20,color:"white"}),(0,x.jsx)(u.default,{style:O.buttonText,children:"Analyze Speech"})]})]})})]})]})},L=(0,s.createNativeStackNavigator)();(0,o.default)((function(){return(0,x.jsx)(l.default,{children:(0,x.jsxs)(i.NavigationContainer,{children:[(0,x.jsx)(a.StatusBar,{style:"auto"}),(0,x.jsxs)(L.Navigator,{initialRouteName:"Home",screenOptions:{headerShown:!1,animation:"slide_from_right"},children:[(0,x.jsx)(L.Screen,{name:"Home",component:p}),(0,x.jsx)(L.Screen,{name:"Record",component:B}),(0,x.jsx)(L.Screen,{name:"Preview",component:P})]})]})})}))},9812:(e,t,r)=>{e.exports=r.p+"static/media/icon.f6e74709ddb35ea644bd.png"}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,r),a.exports}r.m=e,(()=>{var e=[];r.O=(t,o,n,a)=>{if(!o){var i=1/0;for(d=0;d<e.length;d++){for(var[o,n,a]=e[d],s=!0,l=0;l<o.length;l++)(!1&a||i>=a)&&Object.keys(r.O).every((e=>r.O[e](o[l])))?o.splice(l--,1):(s=!1,a<i&&(i=a));if(s){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[o,n,a]}})(),r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/lipseek/",(()=>{var e={792:0};r.O.j=t=>0===e[t];var t=(t,o)=>{var n,a,[i,s,l]=o,c=0;if(i.some((t=>0!==e[t]))){for(n in s)r.o(s,n)&&(r.m[n]=s[n]);if(l)var d=l(r)}for(t&&t(o);c<i.length;c++)a=i[c],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(d)},o=self.webpackChunkweb=self.webpackChunkweb||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var o=r.O(void 0,[974],(()=>r(2388)));o=r.O(o)})();
//# sourceMappingURL=main.3715a8cd.js.map